# AGENT ROUTER (EXECUTE FIRST)

Follow this router before any action. Do not explore outside the relevant README.

**IF** task involves [CUSTOMIZE: your common patterns - e.g., "database queries, API calls, form validation"] →
→ **Read `docs/AI_DOMAIN_TRANSLATION_GUIDE.md` FIRST** (quick reference for project patterns)
→ Then read domain-specific documentation if needed
→ Work in: [CUSTOMIZE: relevant directories]

**IF** task involves [CUSTOMIZE: known limitations - e.g., "image processing, API timeouts, large file operations"] →
→ **Check `docs/AI_CAPABILITIES_AND_LIMITS.md` FIRST** (capability thresholds + workarounds)
→ Then proceed with appropriate workaround
→ Work in: [CUSTOMIZE: relevant directories]

**IF** user asks about AI guides system, PRP system, pattern recognition protocol, maintaining guides, or how to use translation/capabilities guides →
→ **Read `docs/AI_GUIDES_USAGE_SUMMARY.md` FIRST** (quick start - how system works)
→ **For maintenance**: `docs/AI_GUIDES_MAINTENANCE_PLAN.md` (when/how to update guides)
→ **Three-command workflow** (systematic maintenance - also called "PRP" or Pattern Recognition Protocol):
  - `/ai-guides-discover [scope]` - Find patterns/limits/anti-patterns after completing work
  - `/ai-guides-assess [item_ids]` - Score materiality with objective framework (40 points)
  - `/ai-guides-update [item_ids]` - Execute updates with quality control
  - See: AI_GUIDES_MAINTENANCE_PLAN.md → "Operational Maintenance Workflow" section
→ **For validation**: Run `bash tools/validate_ai_guides.sh` (monthly health check)
→ **The two guides**:
  - `docs/AI_DOMAIN_TRANSLATION_GUIDE.md` - Quick pattern lookup
  - `docs/AI_CAPABILITIES_AND_LIMITS.md` - Tool limits and workarounds
→ **Key insight**: Guides are living documents - update when workflows change (monthly validation required)

**IF** task involves creating detailed specification, planning complex feature, or need comprehensive implementation guide →
→ **Use PRP methodology** for context-rich specifications
→ **Workflow**:
  1. Create rough outline in PRPs/in-progress/INITIAL.md
  2. Run `/prp-create PRPs/in-progress/INITIAL.md` (auto-pulls patterns from AI guides)
  3. Review generated PRP, add context
  4. Run `/prp-base-execute [prp-file].md` for implementation
→ **PRP types**:
  - PLANNING PRP: Transform rough idea → comprehensive PRD (30-60 min)
  - BASE PRP: Requirements → implementation with validation (1-2 hours)
  - SPEC PRP: Transform existing code systematically (database migrations, refactors)
  - TASK PRP: Break down complex work into checklist with validation
→ **When to use**: Multi-file features, complex logic, need validation loops
→ **Templates**: PRPs/in-progress/.templates/

**IF** task involves looking up existing pattern, quick reference, or "how do we do X" →
→ **Check AI Guides first** (docs/AI_DOMAIN_TRANSLATION_GUIDE.md)
→ **Purpose**: Quick lookup for established patterns
→ **When to use**: Simple operations, existing features, known patterns

**IF** task is straightforward and pattern is clear →
→ **Implement directly** (no PRP needed)
→ **Consider**: After completion, run `/ai-guides-discover` to document new patterns

**DECISION TREE**:
```
New feature request
    ├─ Complex (multi-file, validation needed, unclear approach)
    │  └─> Create PRP → /prp-create → Execute
    │
    ├─ Moderate (established pattern exists)
    │  └─> Check AI Guides → Implement → Document pattern
    │
    └─ Simple (trivial, one file, obvious approach)
       └─> Implement directly
```

[CUSTOMIZE: Add your domain-specific routing rules below]

**IF** task mentions [CUSTOMIZE: domain 1 keywords - e.g., "authentication, users, sessions"] →
→ **Open `[CUSTOMIZE: path/to/README.md]`** and follow it
→ Work in: [CUSTOMIZE: relevant directories]

**IF** task mentions [CUSTOMIZE: domain 2 keywords - e.g., "API endpoints, routes, controllers"] →
→ **Open `[CUSTOMIZE: path/to/README.md]`** and follow it
→ Work in: [CUSTOMIZE: relevant directories]

**IF** task mentions [CUSTOMIZE: domain 3 keywords - e.g., "components, UI, styling"] →
→ **Open `[CUSTOMIZE: path/to/README.md]`** and follow it
→ Work in: [CUSTOMIZE: relevant directories]

**IF** general/exploratory task →
→ Continue reading this file

**AFTER completing significant work** →
→ **IMPORTANT: You SHOULD run**: `/ai-guides-discover conversation`
→ **Always propose this to the user** after completing:
  - Multi-step features
  - Bug fixes that revealed patterns
  - Any work involving repeated operations
  - Operations that hit tool limits or required workarounds
→ **Then**: `/ai-guides-assess` to score materiality (CRITICAL items = update immediately)
→ **Purpose**: Keep guides current, capture patterns while fresh
→ **Don't run if**: Trivial one-off tasks (<30s impact)

**INTEGRATION: PRP + AI Guides**

The two systems work together:

1. **Creating PRPs** (`/prp-create`):
   - Auto-reads docs/AI_DOMAIN_TRANSLATION_GUIDE.md
   - Pulls relevant patterns into "All Needed Context" section
   - References known gotchas from AI guides
   - Example: "Database approach follows AI_DOMAIN_TRANSLATION_GUIDE.md patterns"

2. **Executing PRPs** (`/prp-base-execute`):
   - References AI guides for validation commands
   - Uses documented patterns for implementation
   - Discovers new patterns → suggest `/ai-guides-discover` after completion

3. **Updating AI Guides** (`/ai-guides-discover`):
   - Can optionally scan PRPs/completed/ for patterns
   - Captures learnings from PRP implementations
   - Creates feedback loop: PRP discovers → AI Guides documents → Future PRPs reference

**Workflow Example**:
```
Day 1: Create authentication feature
  → /prp-create PRPs/in-progress/auth-INITIAL.md
  → PRP auto-includes database patterns from AI guides
  → /prp-base-execute auth-feature.md
  → Feature completed, PRP moved to completed/

Day 2: Document new patterns discovered
  → /ai-guides-discover conversation
  → Finds: OAuth gotcha, session storage pattern
  → /ai-guides-assess DISC-001,DISC-002
  → /ai-guides-update DISC-001 (CRITICAL item)

Day 3: Create related feature (social login)
  → /prp-create social-login-INITIAL.md
  → PRP auto-includes newly documented OAuth pattern
  → Faster implementation with documented learnings
```

**ALWAYS respect repo rules**:
[CUSTOMIZE: Add your project-specific rules - e.g., "No secrets in git", "Always run tests before commit"]

---

# CLAUDE.md

Agent instructions for working in [CUSTOMIZE: your project name].

## Project Mission

[CUSTOMIZE: Brief description of what this project is and what it does]

---

## Critical Standards

### [CUSTOMIZE: Standard 1 - e.g., "TypeScript Standards"]

[CUSTOMIZE: Key standards your project follows]

### [CUSTOMIZE: Standard 2 - e.g., "Testing Requirements"]

[CUSTOMIZE: Testing approach, coverage requirements, etc.]

### Repository Rules

[CUSTOMIZE: Add your repository rules - e.g., "Never commit node_modules", "All PRs require review"]

---

## Repository Structure

```
[CUSTOMIZE: Add your project structure]
project-root/
├── src/
│   ├── components/
│   ├── pages/
│   └── utils/
├── tests/
├── docs/
│   ├── AI_DOMAIN_TRANSLATION_GUIDE.md
│   ├── AI_CAPABILITIES_AND_LIMITS.md
│   └── [other docs]
└── [other directories]
```

---

## Architecture Principles

[CUSTOMIZE: Key architectural decisions and principles]

**Example principles:**
- Separation of concerns
- Single responsibility
- DRY (Don't Repeat Yourself)
- Test coverage requirements

---

## Standard Workflows

**[CUSTOMIZE: Workflow 1 - e.g., "Adding a New Feature"]**:
1. [Step 1]
2. [Step 2]
3. [Step 3]

**[CUSTOMIZE: Workflow 2 - e.g., "Fixing a Bug"]**:
1. [Step 1]
2. [Step 2]
3. [Step 3]

---

## Command System

**Available Commands**:
```bash
/ai-guides-discover [scope]    # Find patterns from recent work
/ai-guides-assess [item_ids]   # Score materiality
/ai-guides-update [item_ids]   # Update guides
[CUSTOMIZE: Add your custom commands]
```

---

## Critical Documents

### Master Context Files
- `README.md` - Project overview (human onboarding)
- `CLAUDE.md` - This file (agent instructions)
- [CUSTOMIZE: Add your critical documentation files]

---

**When in doubt**:
1. Check router at top of this file for correct README
2. Check if command exists (`.claude/commands/`)
3. Read relevant domain documentation
4. Consult AI guides for established patterns
